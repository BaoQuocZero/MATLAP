% B??c 1: ??c ?nh
r = imread('Fig0304(a)(breast_digital_Xray).tif');  % ??c ?nh ?a m?c xám

% B??c 2: Phân tích s? phân b? m?c xám c?a ?nh r
L = 256;  % S? c?p m?c xám (8-bit ?nh)
sa = L - 1 - r;  % Bi?n ??i âm b?n ?nh

% B??c 3: Chuy?n ??i ?nh thành ?nh nh? phân v?i ng??ng t = 127
t = 127;  % Ng??ng
bw = r >= t;  % T?o ?nh nh? phân: pixel > t là 1, pixel < t là 0

% Hi?n th? các ?nh trong cùng m?t c?a s?
figure;

% ?nh g?c
subplot(2,3,1);  % Chia c?a s? thành 2 hàng, 3 c?t, hi?n th? ?nh g?c ? v? trí 1
imshow(r);
title('?nh g?c');

% L??c ?? m?c xám c?a ?nh g?c
subplot(2,3,2);  % Hi?n th? l??c ?? m?c xám c?a ?nh g?c
imhist(r);
title('L??c ?? m?c xám c?a ?nh g?c');

% ?nh âm b?n
subplot(2,3,3);  % Hi?n th? ?nh âm b?n ? v? trí 3
imshow(sa);
title('?nh âm b?n');

% L??c ?? m?c xám c?a ?nh âm b?n
subplot(2,3,4);  % Hi?n th? l??c ?? m?c xám c?a ?nh âm b?n
imhist(sa);
title('L??c ?? m?c xám c?a ?nh âm b?n');

% ?nh nh? phân
subplot(2,3,5);  % Hi?n th? ?nh nh? phân ? v? trí 5
imshow(bw);
title('?nh nh? phân');

% L??c ?? m?c xám c?a ?nh nh? phân (N?u c?n)
subplot(2,3,6);  % Hi?n th? l??c ?? m?c xám c?a ?nh nh? phân
imhist(bw);
title('L??c ?? m?c xám c?a ?nh nh? phân');